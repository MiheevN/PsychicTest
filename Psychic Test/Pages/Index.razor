@page "/"
@inject TestingGroup Group

<h1 class="text-center">Тестирование экстрасенсов</h1>

<div class="row mb-5 mt-5 justify-content-around">
    <div>
        @if (SecretStage)
        {
            <LastResults />
            <h4>Загадайте 2 значное число</h4>

            <button class="btn btn-block btn-primary" @onclick="ConfirmSecret">Загадал</button>
        }
        else
        {
            <CurrentGuesses />
            <h4>Напишите загаданное число</h4>

            <input class="input-group input-group-text" type="number" min="10" max="99" @bind="NewSecret" />
            <button class="btn btn-block btn-success" @onclick="ConfirmEnter">Отправить</button>
        }
    </div>
    <PsyhicsCards />
</div>
<ExperimentHistory />

@code{
    /// <summary>
    /// 0 - Загадывание числа, 1 - демонстрация догадок, 2 - Результаты
    /// </summary>
    bool SecretStage { get; set; } = true;

    sbyte _secret = 10;
    sbyte NewSecret
    {
        get => _secret;
        set
        {
            _secret = Math.Clamp(value, (sbyte)10, (sbyte)99);
        }
    }

    void ConfirmSecret()
    {
        SecretStage = false;
        Group.MakeGuesses();
    }

    void ConfirmEnter()
    {
        SecretStage = true;
        Group.CheckGuess(NewSecret);
        NewSecret = 10;
    }
}